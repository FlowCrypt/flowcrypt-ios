# fastlane/Fastfile
ENV["FASTLANE_EXPLICIT_OPEN_SIMULATOR"] = "1"

default_platform(:ios)

platform :ios do

  before_all do
    # installed via the semaphore plugin with `fastlane add_plugin semaphore`
    # setup_semaphore
    cocoapods(
      try_repo_update_on_error: true
    )
  end

  desc "Build for UI tests"
  lane :build do
    scan(
      workspace: "FlowCrypt.xcworkspace",
      scheme: "Debug FlowCrypt",
      skip_build: false,
      derived_data_path: "/var/tmp/derived_data",
      build_for_testing: true
    )
  end

  desc "Run Swift tests"
  lane :test do
    scan(
      workspace: "FlowCrypt.xcworkspace",
      scheme: "FlowCryptAppTests",
      test_without_building: true,
      derived_data_path: "/var/tmp/derived_data"
    )
  end

end

